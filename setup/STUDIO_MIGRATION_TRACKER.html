<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BlockForge Studio Migration Tracker</title>
  <style>
    /* ============================================
       BASE STYLES - Mobile First
       ============================================ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #FF5722;
      --primary-dark: #E64A19;
      --success: #4CAF50;
      --warning: #FFC107;
      --gray-50: #FAFAFA;
      --gray-100: #F5F5F5;
      --gray-200: #EEEEEE;
      --gray-300: #E0E0E0;
      --gray-600: #757575;
      --gray-800: #424242;
      --gray-900: #212121;
      --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.15);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: var(--gray-900);
      background: var(--gray-50);
      padding: 1rem;
      max-width: 100%;
      overflow-x: hidden;
    }

    /* ============================================
       HEADER
       ============================================ */
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 1.5rem 1rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      box-shadow: var(--shadow-lg);
    }

    .header h1 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      font-weight: 700;
    }

    .header p {
      opacity: 0.95;
      font-size: 0.9rem;
    }

    /* ============================================
       PROGRESS BAR
       ============================================ */
    .progress-section {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      box-shadow: var(--shadow);
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .progress-header h2 {
      font-size: 1.1rem;
      color: var(--gray-800);
    }

    .progress-percent {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
    }

    .progress-bar-container {
      background: var(--gray-200);
      height: 12px;
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: 1rem;
    }

    .progress-bar-fill {
      background: linear-gradient(90deg, var(--success) 0%, #66BB6A 100%);
      height: 100%;
      border-radius: 6px;
      transition: width 0.5s ease;
      width: 0%;
    }

    .progress-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
    }

    .stat-card {
      background: var(--gray-50);
      padding: 0.75rem;
      border-radius: 8px;
      text-align: center;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
      display: block;
    }

    .stat-label {
      font-size: 0.75rem;
      color: var(--gray-600);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 0.25rem;
    }

    /* ============================================
       TIMER
       ============================================ */
    .timer-section {
      background: white;
      padding: 1rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      box-shadow: var(--shadow);
      text-align: center;
    }

    .timer-display {
      font-size: 2rem;
      font-weight: 700;
      font-family: 'Courier New', monospace;
      color: var(--gray-800);
      margin: 0.5rem 0;
      letter-spacing: 2px;
    }

    .timer-buttons {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      margin-top: 1rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: var(--shadow);
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .btn-secondary {
      background: var(--gray-200);
      color: var(--gray-800);
    }

    .btn-secondary:hover {
      background: var(--gray-300);
    }

    .btn-success {
      background: var(--success);
      color: white;
    }

    /* ============================================
       PHASE SECTIONS
       ============================================ */
    .phase {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: var(--shadow);
    }

    .phase-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--gray-200);
    }

    .phase-title {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .phase-icon {
      width: 32px;
      height: 32px;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.9rem;
      flex-shrink: 0;
    }

    .phase-icon.complete {
      background: var(--success);
    }

    .phase h3 {
      font-size: 1.1rem;
      color: var(--gray-800);
      font-weight: 600;
    }

    .phase-time {
      background: var(--gray-100);
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.85rem;
      color: var(--gray-600);
      white-space: nowrap;
    }

    .phase-description {
      color: var(--gray-600);
      font-size: 0.9rem;
      margin-bottom: 1rem;
      line-height: 1.5;
    }

    /* ============================================
       CHECKLIST ITEMS
       ============================================ */
    .checklist {
      list-style: none;
    }

    .checklist-item {
      display: flex;
      align-items: flex-start;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      border-radius: 8px;
      background: var(--gray-50);
      transition: all 0.2s;
      cursor: pointer;
      -webkit-user-select: none;
      user-select: none;
    }

    .checklist-item:hover {
      background: var(--gray-100);
      transform: translateX(4px);
    }

    .checklist-item.completed {
      background: #E8F5E9;
      opacity: 0.8;
    }

    .checkbox {
      width: 24px;
      height: 24px;
      border: 2px solid var(--gray-300);
      border-radius: 6px;
      margin-right: 0.75rem;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .checklist-item.completed .checkbox {
      background: var(--success);
      border-color: var(--success);
    }

    .checkbox::after {
      content: '‚úì';
      color: white;
      font-weight: 700;
      font-size: 0.9rem;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .checklist-item.completed .checkbox::after {
      opacity: 1;
    }

    .checklist-text {
      flex: 1;
      font-size: 0.95rem;
      line-height: 1.5;
    }

    .checklist-item.completed .checklist-text {
      text-decoration: line-through;
      color: var(--gray-600);
    }

    /* ============================================
       ACTION BUTTONS
       ============================================ */
    .action-section {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      box-shadow: var(--shadow);
    }

    .action-section h3 {
      font-size: 1rem;
      margin-bottom: 1rem;
      color: var(--gray-800);
    }

    .action-buttons {
      display: grid;
      grid-template-columns: 1fr;
      gap: 0.75rem;
    }

    .action-btn {
      width: 100%;
      padding: 1rem;
      border: 2px solid var(--gray-300);
      border-radius: 8px;
      background: white;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.2s;
      text-align: left;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .action-btn:hover {
      border-color: var(--primary);
      background: var(--gray-50);
      transform: translateX(4px);
    }

    .action-btn-icon {
      font-size: 1.2rem;
    }

    /* ============================================
       PRINT STYLES
       ============================================ */
    @media print {
      body {
        background: white;
        padding: 0;
      }

      .header {
        background: white;
        color: black;
        border: 2px solid black;
        page-break-after: avoid;
      }

      .timer-section,
      .action-section {
        display: none;
      }

      .phase {
        page-break-inside: avoid;
        border: 1px solid #ddd;
        margin-bottom: 1rem;
      }

      .checklist-item {
        border: 1px solid #eee;
        margin-bottom: 0.25rem;
      }

      .btn {
        display: none;
      }

      .progress-section {
        page-break-after: avoid;
      }
    }

    /* ============================================
       TABLET & DESKTOP
       ============================================ */
    @media (min-width: 768px) {
      body {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
      }

      .header h1 {
        font-size: 2rem;
      }

      .progress-stats {
        grid-template-columns: repeat(4, 1fr);
      }

      .action-buttons {
        grid-template-columns: repeat(2, 1fr);
      }

      .timer-display {
        font-size: 3rem;
      }
    }

    /* ============================================
       DARK MODE (Optional)
       ============================================ */
    @media (prefers-color-scheme: dark) {
      :root {
        --gray-50: #1E1E1E;
        --gray-100: #2D2D2D;
        --gray-200: #3D3D3D;
        --gray-300: #4D4D4D;
        --gray-600: #B0B0B0;
        --gray-800: #E0E0E0;
        --gray-900: #FFFFFF;
      }

      body {
        background: #121212;
        color: var(--gray-900);
      }

      .phase,
      .progress-section,
      .timer-section,
      .action-section {
        background: var(--gray-100);
      }

      .checklist-item {
        background: var(--gray-200);
      }

      .checklist-item:hover {
        background: var(--gray-300);
      }
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <div class="header">
    <h1>üèóÔ∏è Studio Migration Tracker</h1>
    <p>BlockForge Platform - 60-Minute Migration Checklist</p>
  </div>

  <!-- PROGRESS SECTION -->
  <div class="progress-section">
    <div class="progress-header">
      <h2>Overall Progress</h2>
      <span class="progress-percent" id="progressPercent">0%</span>
    </div>
    <div class="progress-bar-container">
      <div class="progress-bar-fill" id="progressBar"></div>
    </div>
    <div class="progress-stats">
      <div class="stat-card">
        <span class="stat-value" id="completedCount">0</span>
        <span class="stat-label">Completed</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="totalCount">26</span>
        <span class="stat-label">Total Tasks</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="elapsedTime">00:00</span>
        <span class="stat-label">Time Spent</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="estimatedRemaining">60m</span>
        <span class="stat-label">Est. Remaining</span>
      </div>
    </div>
  </div>

  <!-- TIMER SECTION -->
  <div class="timer-section">
    <h3>Session Timer</h3>
    <div class="timer-display" id="timerDisplay">00:00:00</div>
    <div class="timer-buttons">
      <button class="btn btn-primary" id="startTimer">‚ñ∂ Start</button>
      <button class="btn btn-secondary" id="pauseTimer">‚è∏ Pause</button>
      <button class="btn btn-secondary" id="resetTimer">‚Üª Reset</button>
    </div>
  </div>

  <!-- PHASE A: AUDIT (10 min) -->
  <div class="phase">
    <div class="phase-header">
      <div class="phase-title">
        <div class="phase-icon">A</div>
        <div>
          <h3>Phase A: Audit Original HTML</h3>
        </div>
      </div>
      <div class="phase-time">10 min</div>
    </div>
    <p class="phase-description">Analyze the original HTML demo to identify unique features, algorithms, and dependencies.</p>
    <ul class="checklist" data-phase="a">
      <li class="checklist-item" data-task="a1">
        <div class="checkbox"></div>
        <div class="checklist-text">Locate and open the original HTML file (relief.html, 3d.html, etc.)</div>
      </li>
      <li class="checklist-item" data-task="a2">
        <div class="checkbox"></div>
        <div class="checklist-text">Identify input types (file upload, text, sliders, dropdowns, checkboxes)</div>
      </li>
      <li class="checklist-item" data-task="a3">
        <div class="checkbox"></div>
        <div class="checklist-text">Document unique algorithms (height mapping, K-means, QR generation, etc.)</div>
      </li>
      <li class="checklist-item" data-task="a4">
        <div class="checkbox"></div>
        <div class="checklist-text">Note external dependencies (QRCode.js, Three.js, jsPDF, etc.)</div>
      </li>
      <li class="checklist-item" data-task="a5">
        <div class="checkbox"></div>
        <div class="checklist-text">List all export formats (PNG, CSV, HTML, PDF, STL)</div>
      </li>
      <li class="checklist-item" data-task="a6">
        <div class="checkbox"></div>
        <div class="checklist-text">Identify rendering style (2D canvas, isometric, 3D, circular studs)</div>
      </li>
    </ul>
  </div>

  <!-- PHASE B: SETUP (5 min) -->
  <div class="phase">
    <div class="phase-header">
      <div class="phase-title">
        <div class="phase-icon">B</div>
        <div>
          <h3>Phase B: Setup Plugin Structure</h3>
        </div>
      </div>
      <div class="phase-time">5 min</div>
    </div>
    <p class="phase-description">Create plugin directory and write manifest.json with UI configuration.</p>
    <ul class="checklist" data-phase="b">
      <li class="checklist-item" data-task="b1">
        <div class="checkbox"></div>
        <div class="checklist-text">Create plugins/[studio-id]/ directory</div>
      </li>
      <li class="checklist-item" data-task="b2">
        <div class="checkbox"></div>
        <div class="checklist-text">Create manifest.json with id, name, version, description</div>
      </li>
      <li class="checklist-item" data-task="b3">
        <div class="checkbox"></div>
        <div class="checklist-text">Define UI tools array (file upload, sliders, dropdowns, checkboxes)</div>
      </li>
      <li class="checklist-item" data-task="b4">
        <div class="checkbox"></div>
        <div class="checklist-text">Define UI panels (preview canvas, stats html)</div>
      </li>
    </ul>
  </div>

  <!-- PHASE C: EXTRACT (10 min) -->
  <div class="phase">
    <div class="phase-header">
      <div class="phase-title">
        <div class="phase-icon">C</div>
        <div>
          <h3>Phase C: Extract Assets & Data</h3>
        </div>
      </div>
      <div class="phase-time">10 min</div>
    </div>
    <p class="phase-description">Move fonts, palettes, and data files to plugin assets folder.</p>
    <ul class="checklist" data-phase="c">
      <li class="checklist-item" data-task="c1">
        <div class="checkbox"></div>
        <div class="checklist-text">Create assets/ folder in plugin directory</div>
      </li>
      <li class="checklist-item" data-task="c2">
        <div class="checkbox"></div>
        <div class="checklist-text">Extract font data (if text-based studio)</div>
      </li>
      <li class="checklist-item" data-task="c3">
        <div class="checkbox"></div>
        <div class="checklist-text">Extract color palettes (if image-based studio)</div>
      </li>
      <li class="checklist-item" data-task="c4">
        <div class="checkbox"></div>
        <div class="checklist-text">Extract any lookup tables or data files</div>
      </li>
    </ul>
  </div>

  <!-- PHASE D: IMPLEMENT (25 min) -->
  <div class="phase">
    <div class="phase-header">
      <div class="phase-title">
        <div class="phase-icon">D</div>
        <div>
          <h3>Phase D: Implement Plugin</h3>
        </div>
      </div>
      <div class="phase-time">25 min</div>
    </div>
    <p class="phase-description">Build the plugin class with full lifecycle implementation.</p>
    <ul class="checklist" data-phase="d">
      <li class="checklist-item" data-task="d1">
        <div class="checkbox"></div>
        <div class="checklist-text">Create [studio-id].js plugin file from template</div>
      </li>
      <li class="checklist-item" data-task="d2">
        <div class="checkbox"></div>
        <div class="checklist-text">Implement constructor with state properties</div>
      </li>
      <li class="checklist-item" data-task="d3">
        <div class="checkbox"></div>
        <div class="checklist-text">Implement init() - get canvas, setup listeners</div>
      </li>
      <li class="checklist-item" data-task="d4">
        <div class="checkbox"></div>
        <div class="checklist-text">Wire event listeners to manifest tool IDs</div>
      </li>
      <li class="checklist-item" data-task="d5">
        <div class="checkbox"></div>
        <div class="checklist-text">Extend Voxelizer if needed (fromHeightMap, from3DModel, etc.)</div>
      </li>
      <li class="checklist-item" data-task="d6">
        <div class="checkbox"></div>
        <div class="checklist-text">Implement render() - voxelize ‚Üí optimize ‚Üí draw</div>
      </li>
      <li class="checklist-item" data-task="d7">
        <div class="checkbox"></div>
        <div class="checklist-text">Implement renderToCanvas() with studio-specific style</div>
      </li>
      <li class="checklist-item" data-task="d8">
        <div class="checkbox"></div>
        <div class="checklist-text">Implement updateStats() - display brick counts</div>
      </li>
      <li class="checklist-item" data-task="d9">
        <div class="checkbox"></div>
        <div class="checklist-text">Implement export() router (PNG, CSV, HTML)</div>
      </li>
    </ul>
  </div>

  <!-- PHASE E: TEST (10 min) -->
  <div class="phase">
    <div class="phase-header">
      <div class="phase-title">
        <div class="phase-icon">E</div>
        <div>
          <h3>Phase E: Test & Verify</h3>
        </div>
      </div>
      <div class="phase-time">10 min</div>
    </div>
    <p class="phase-description">Comprehensive testing to ensure everything works correctly.</p>
    <ul class="checklist" data-phase="e">
      <li class="checklist-item" data-task="e1">
        <div class="checkbox"></div>
        <div class="checklist-text">Run npm run scan-plugins (should show new studio)</div>
      </li>
      <li class="checklist-item" data-task="e2">
        <div class="checkbox"></div>
        <div class="checklist-text">Start dev server (npm run dev)</div>
      </li>
      <li class="checklist-item" data-task="e3">
        <div class="checkbox"></div>
        <div class="checklist-text">Select studio from dropdown (loads without errors)</div>
      </li>
      <li class="checklist-item" data-task="e4">
        <div class="checkbox"></div>
        <div class="checklist-text">Test input controls (upload/text/sliders all work)</div>
      </li>
      <li class="checklist-item" data-task="e5">
        <div class="checkbox"></div>
        <div class="checklist-text">Verify canvas renders output correctly</div>
      </li>
      <li class="checklist-item" data-task="e6">
        <div class="checkbox"></div>
        <div class="checklist-text">Test PNG export (downloads correctly)</div>
      </li>
      <li class="checklist-item" data-task="e7">
        <div class="checkbox"></div>
        <div class="checklist-text">Test CSV export (parts list accurate)</div>
      </li>
      <li class="checklist-item" data-task="e8">
        <div class="checkbox"></div>
        <div class="checklist-text">Test HTML export (instructions formatted)</div>
      </li>
      <li class="checklist-item" data-task="e9">
        <div class="checkbox"></div>
        <div class="checklist-text">Test plugin switching (can switch away and back)</div>
      </li>
    </ul>
  </div>

  <!-- PHASE F: DOCUMENT (5 min) -->
  <div class="phase">
    <div class="phase-header">
      <div class="phase-title">
        <div class="phase-icon">F</div>
        <div>
          <h3>Phase F: Document & Commit</h3>
        </div>
      </div>
      <div class="phase-time">5 min</div>
    </div>
    <p class="phase-description">Update documentation and commit your work.</p>
    <ul class="checklist" data-phase="f">
      <li class="checklist-item" data-task="f1">
        <div class="checkbox"></div>
        <div class="checklist-text">Create/update plugin README.md (features, usage, exports)</div>
      </li>
      <li class="checklist-item" data-task="f2">
        <div class="checkbox"></div>
        <div class="checklist-text">Update root README.md (add studio to Available Studios)</div>
      </li>
      <li class="checklist-item" data-task="f3">
        <div class="checkbox"></div>
        <div class="checklist-text">Update PROJECT_STATE.md (mark task complete, update progress)</div>
      </li>
      <li class="checklist-item" data-task="f4">
        <div class="checkbox"></div>
        <div class="checklist-text">Run git add . && git commit -m "Task X-Y complete: [Studio] migrated"</div>
      </li>
      <li class="checklist-item" data-task="f5">
        <div class="checkbox"></div>
        <div class="checklist-text">Push to GitHub (git push)</div>
      </li>
    </ul>
  </div>

  <!-- ACTION BUTTONS -->
  <div class="action-section">
    <h3>Quick Actions</h3>
    <div class="action-buttons">
      <button class="action-btn" onclick="resetProgress()">
        <span>‚Üª Reset All Progress</span>
        <span class="action-btn-icon">üîÑ</span>
      </button>
      <button class="action-btn" onclick="window.print()">
        <span>üñ®Ô∏è Print Report</span>
        <span class="action-btn-icon">üìÑ</span>
      </button>
      <button class="action-btn" onclick="exportProgress()">
        <span>üíæ Export Progress (JSON)</span>
        <span class="action-btn-icon">üì•</span>
      </button>
      <button class="action-btn" onclick="document.getElementById('importFile').click()">
        <span>üìÇ Import Progress</span>
        <span class="action-btn-icon">üì§</span>
      </button>
    </div>
    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importProgress(event)">
  </div>

  <!-- JAVASCRIPT -->
  <script>
    // ============================================
    // STATE MANAGEMENT
    // ============================================
    let progress = {
      tasks: {},
      startTime: null,
      elapsedSeconds: 0,
      timerRunning: false
    };

    // Load saved progress from localStorage
    function loadProgress() {
      const saved = localStorage.getItem('blockforge-migration-progress');
      if (saved) {
        progress = JSON.parse(saved);
        updateUI();
      }
    }

    // Save progress to localStorage
    function saveProgress() {
      localStorage.setItem('blockforge-migration-progress', JSON.stringify(progress));
    }

    // ============================================
    // CHECKLIST INTERACTION
    // ============================================
    function initializeChecklistItems() {
      const items = document.querySelectorAll('.checklist-item');
      items.forEach(item => {
        const taskId = item.getAttribute('data-task');
        
        // Restore saved state
        if (progress.tasks[taskId]) {
          item.classList.add('completed');
        }
        
        // Click handler
        item.addEventListener('click', () => {
          const isCompleted = item.classList.toggle('completed');
          progress.tasks[taskId] = isCompleted;
          saveProgress();
          updateProgress();
        });
      });
    }

    // ============================================
    // PROGRESS CALCULATION
    // ============================================
    function updateProgress() {
      const totalTasks = document.querySelectorAll('.checklist-item').length;
      const completedTasks = Object.values(progress.tasks).filter(Boolean).length;
      const percent = Math.round((completedTasks / totalTasks) * 100);
      
      // Update progress bar
      document.getElementById('progressBar').style.width = percent + '%';
      document.getElementById('progressPercent').textContent = percent + '%';
      
      // Update stats
      document.getElementById('completedCount').textContent = completedTasks;
      document.getElementById('totalCount').textContent = totalTasks;
      
      // Estimate remaining time (60 min total - elapsed time - completed percentage)
      const estimatedTotal = 60; // minutes
      const estimatedDone = Math.round((completedTasks / totalTasks) * estimatedTotal);
      const estimatedRemaining = Math.max(0, estimatedTotal - estimatedDone);
      document.getElementById('estimatedRemaining').textContent = estimatedRemaining + 'm';
      
      // Update phase icons
      updatePhaseIcons();
    }

    function updatePhaseIcons() {
      const phases = ['a', 'b', 'c', 'd', 'e', 'f'];
      phases.forEach(phase => {
        const phaseList = document.querySelector(`[data-phase="${phase}"]`);
        const phaseItems = phaseList.querySelectorAll('.checklist-item');
        const completedItems = Array.from(phaseItems).filter(item => 
          item.classList.contains('completed')
        ).length;
        
        const icon = phaseList.closest('.phase').querySelector('.phase-icon');
        if (completedItems === phaseItems.length) {
          icon.classList.add('complete');
        } else {
          icon.classList.remove('complete');
        }
      });
    }

    // ============================================
    // TIMER FUNCTIONALITY
    // ============================================
    let timerInterval = null;

    function formatTime(seconds) {
      const hrs = Math.floor(seconds / 3600);
      const mins = Math.floor((seconds % 3600) / 60);
      const secs = seconds % 60;
      return `${String(hrs).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    }

    function updateTimerDisplay() {
      const display = document.getElementById('timerDisplay');
      display.textContent = formatTime(progress.elapsedSeconds);
      
      const elapsedDisplay = document.getElementById('elapsedTime');
      const mins = Math.floor(progress.elapsedSeconds / 60);
      const secs = progress.elapsedSeconds % 60;
      elapsedDisplay.textContent = `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    }

    function startTimer() {
      if (progress.timerRunning) return;
      
      progress.timerRunning = true;
      progress.startTime = Date.now() - (progress.elapsedSeconds * 1000);
      
      timerInterval = setInterval(() => {
        progress.elapsedSeconds = Math.floor((Date.now() - progress.startTime) / 1000);
        updateTimerDisplay();
        saveProgress();
      }, 1000);
      
      document.getElementById('startTimer').textContent = '‚ñ∂ Running...';
      document.getElementById('startTimer').disabled = true;
    }

    function pauseTimer() {
      if (!progress.timerRunning) return;
      
      progress.timerRunning = false;
      clearInterval(timerInterval);
      saveProgress();
      
      document.getElementById('startTimer').textContent = '‚ñ∂ Start';
      document.getElementById('startTimer').disabled = false;
    }

    function resetTimer() {
      pauseTimer();
      progress.elapsedSeconds = 0;
      progress.startTime = null;
      updateTimerDisplay();
      saveProgress();
    }

    // Timer button handlers
    document.getElementById('startTimer').addEventListener('click', startTimer);
    document.getElementById('pauseTimer').addEventListener('click', pauseTimer);
    document.getElementById('resetTimer').addEventListener('click', resetTimer);

    // ============================================
    // RESET FUNCTIONALITY
    // ============================================
    function resetProgress() {
      if (!confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
        return;
      }
      
      progress = {
        tasks: {},
        startTime: null,
        elapsedSeconds: 0,
        timerRunning: false
      };
      
      pauseTimer();
      saveProgress();
      
      // Reset UI
      document.querySelectorAll('.checklist-item').forEach(item => {
        item.classList.remove('completed');
      });
      
      updateProgress();
      updateTimerDisplay();
    }

    // ============================================
    // IMPORT/EXPORT
    // ============================================
    function exportProgress() {
      const dataStr = JSON.stringify(progress, null, 2);
      const blob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = `blockforge-migration-progress-${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function importProgress(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          progress = JSON.parse(e.target.result);
          saveProgress();
          location.reload(); // Reload to apply imported progress
        } catch (error) {
          alert('Invalid progress file. Please select a valid JSON export.');
        }
      };
      reader.readAsText(file);
    }

    // ============================================
    // INITIALIZATION
    // ============================================
    function updateUI() {
      // Restore checklist states
      Object.entries(progress.tasks).forEach(([taskId, completed]) => {
        if (completed) {
          const item = document.querySelector(`[data-task="${taskId}"]`);
          if (item) item.classList.add('completed');
        }
      });
      
      // Update progress display
      updateProgress();
      
      // Update timer display
      updateTimerDisplay();
      
      // Resume timer if it was running
      if (progress.timerRunning) {
        startTimer();
      }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', () => {
      loadProgress();
      initializeChecklistItems();
      updateProgress();
      updateTimerDisplay();
    });

    // Auto-save on page unload
    window.addEventListener('beforeunload', () => {
      saveProgress();
    });
  </script>

</body>
</html>
